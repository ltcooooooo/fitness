{"ast":null,"code":"import { login } from \"@/api/api\";\nimport { setToken, setUserInfo } from \"@/utils/me\";\nexport default {\n  data() {\n    return {\n      username: \"\",\n      weight: \"\",\n      weightShow: false,\n      weightStyle: {\n        height: \"0\",\n        border: \"none\"\n      }\n    };\n  },\n\n  methods: {\n    nameInput() {\n      console.log(event.target.value);\n      this.username = this.username.replace(/[ ]/g, \"\");\n    },\n\n    loginBtn() {\n      //为输入用户名弹出提示\n      if (!this.username) return this.Notify({\n        type: \"warning\",\n        message: \"请输入你的名字\"\n      }); //未检测到用户，显示体重输入框\n\n      if (!this.weightShow) {\n        login(this.username).then(res => {\n          //请求成功\n          if (res.data.status) {\n            //检测是否有token，没有则为新用户\n            if (!res.data.token) {\n              this.Dialog.alert({\n                title: \"提示\",\n                message: \"未检测到该用户，首次登陆请先输入你的体重\"\n              }).then(value => {\n                this.weightShow = true;\n                this.weightStyle.border = \"0.2564vw solid #ccc\";\n                this.weightStyle.height = \"10vw\";\n              }); //登陆成功\n            } else {\n              setToken(res.data.token);\n              setUserInfo(res.data.user);\n              this.$router.replace(\"/mine\");\n            }\n          }\n        });\n      } else {\n        if (!this.weight) return this.Notify({\n          type: \"warning\",\n          message: \"请输入你的体重\"\n        });\n        login(this.username, this.weight).then(res => {\n          setToken(res.data.token);\n          setUserInfo(res.data.user);\n          this.$router.replace(\"/mine\");\n        });\n      }\n    }\n\n  },\n  watch: {// username(newValue, oldValue) {\n    //   const str = newValue.replace(/\\0/, \"\");\n    //   console.log(str)\n    // },\n  }\n};","map":{"version":3,"mappings":"AAyBA;AACA;AACA;EACAA;IACA;MACAC,YADA;MAEAC,UAFA;MAGAC,iBAHA;MAIAC;QAAAC;QAAAC;MAAA;IAJA;EAMA,CARA;;EASAC;IACAC;MACAC;MACA;IACA,CAJA;;IAKAC;MACA;MACA,oBACA;QAAAC;QAAAC;MAAA,GAHA,CAIA;;MACA;QACAC;UACA;UACA;YACA;YACA;cACA;gBACAC,WADA;gBAEAF;cAFA,GAGAG,IAHA,CAGAC;gBACA;gBACA;gBACA;cACA,CAPA,EADA,CASA;YACA,CAVA,MAUA;cACAC;cACAC;cACA;YACA;UACA;QACA,CApBA;MAqBA,CAtBA,MAsBA;QACA,kBACA;UAAAP;UAAAC;QAAA;QACAC;UACAI;UACAC;UACA;QACA,CAJA;MAKA;IACA;;EAzCA,CATA;EAoDAC,QACA;IACA;IACA;IACA;EAJA;AApDA","names":["data","username","weight","weightShow","weightStyle","height","border","methods","nameInput","console","loginBtn","type","message","login","title","then","value","setToken","setUserInfo","watch"],"sourceRoot":"src/views","sources":["Login.vue"],"sourcesContent":["<template>\r\n  <div id=\"login\">\r\n    <div class=\"content\">\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"请输入你的名字\"\r\n        v-model=\"username\"\r\n        @input=\"username = username.replace(/[ ]/g, '')\"\r\n      />\r\n      <input\r\n        class=\"weight\"\r\n        type=\"number\"\r\n        :placeholder=\"weightShow ? '请输入你的体重' : ''\"\r\n        v-model=\"weight\"\r\n        :style=\"weightStyle\"\r\n        @input=\"weight = weight.replace(/[ e]/g, '')\"\r\n      />\r\n      <van-button type=\"info\" style=\"border-radius: 2vw\" @click=\"loginBtn\"\r\n        >登录</van-button\r\n      >\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { login } from \"@/api/api\";\r\nimport { setToken, setUserInfo } from \"@/utils/me\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      username: \"\",\r\n      weight: \"\",\r\n      weightShow: false,\r\n      weightStyle: { height: \"0\", border: \"none\" },\r\n    };\r\n  },\r\n  methods: {\r\n    nameInput() {\r\n      console.log(event.target.value);\r\n      this.username = this.username.replace(/[ ]/g, \"\");\r\n    },\r\n    loginBtn() {\r\n      //为输入用户名弹出提示\r\n      if (!this.username)\r\n        return this.Notify({ type: \"warning\", message: \"请输入你的名字\" });\r\n      //未检测到用户，显示体重输入框\r\n      if (!this.weightShow) {\r\n        login(this.username).then((res) => {\r\n          //请求成功\r\n          if (res.data.status) {\r\n            //检测是否有token，没有则为新用户\r\n            if (!res.data.token) {\r\n              this.Dialog.alert({\r\n                title: \"提示\",\r\n                message: \"未检测到该用户，首次登陆请先输入你的体重\",\r\n              }).then((value) => {\r\n                this.weightShow = true;\r\n                this.weightStyle.border = \"0.2564vw solid #ccc\";\r\n                this.weightStyle.height = \"10vw\";\r\n              });\r\n              //登陆成功\r\n            } else {\r\n              setToken(res.data.token);\r\n              setUserInfo(res.data.user);\r\n              this.$router.replace(\"/mine\");\r\n            }\r\n          }\r\n        });\r\n      } else {\r\n        if (!this.weight)\r\n          return this.Notify({ type: \"warning\", message: \"请输入你的体重\" });\r\n        login(this.username, this.weight).then((res) => {\r\n          setToken(res.data.token);\r\n          setUserInfo(res.data.user);\r\n          this.$router.replace(\"/mine\");\r\n        });\r\n      }\r\n    },\r\n  },\r\n  watch: {\r\n    // username(newValue, oldValue) {\r\n    //   const str = newValue.replace(/\\0/, \"\");\r\n    //   console.log(str)\r\n    // },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n#login {\r\n  display: flex;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  justify-content: center;\r\n  align-items: center;\r\n  .content {\r\n    display: flex;\r\n    flex-direction: column;\r\n    input {\r\n      margin: 0 auto;\r\n      width: 50vw;\r\n      height: 10vw;\r\n      text-align: center;\r\n      border-radius: 2vw;\r\n      box-sizing: border-box;\r\n      border: 0.2564vw solid #ccc;\r\n      margin-bottom: 2.1282vw;\r\n      padding: 0;\r\n      transition: 0.5s;\r\n    }\r\n    .weight {\r\n      transition: 0.5s;\r\n    }\r\n    input::-webkit-outer-spin-button,\r\n    input::-webkit-inner-spin-button {\r\n      -webkit-appearance: none !important;\r\n      margin: 0;\r\n    }\r\n    input[type=\"number\"] {\r\n      -moz-appearance: textfield;\r\n    }\r\n  }\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}